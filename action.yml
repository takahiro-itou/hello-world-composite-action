
name : 'Hello World'
description : 'Greet someone'

inputs :
  who-to-greet : # id of input
    description : 'Who to greet'
    required    : true
    default     : 'World'

outputs :
  random-number :
    description : "Random number"
    value : ${{ steps.random-number-generator.outputs.random-number }}

runs:
  using : "composite"
  steps :
    - name : Initialize
      run  : |
        pwd
        mkdir -p init
        ls -alR
      shell : bash

    - name : Cache Common Value
      id   : cache-common-value
      uses : actions/cache@v3
      env  :
        cache-name : cache-common-value
      with :
        path : init/cached-common-value.txt
        key  : ${{ runner.os }}-${{ env.cache-name }}

    - name : Write Cache
      run  : |
        echo "$(echo $RANDOM)" | tee init/cached-common-value.txt
        date | tee -a init/cached-common-value.txt
        ls -l init/
      shell : bash

    - name : Random Number Generator
      run  : |
        echo "$(echo $RANDOM)" | tee init/random.txt
      shell : bash

    - name : Set Greeting
      run  : echo "Hello $INPUT_WHO_TO_GREET."
      shell : bash
      env  :
        INPUT_WHO_TO_GREET : ${{ inputs.who-to-greet }}

    - name : Read Random Number
      id   : random-number-generator
      run  : |
        random_value=$(cat init/random.txt)
        echo "random-number=${random_value}" >> $GITHUB_OUTPUT
      shell : bash

    - name : Set GitHub Path
      run  : echo "$GITHUB_ACTION_PATH" >> $GITHUB_PATH
      shell : bash
      env  :
        GITHUB_ACTION_PATH : ${{ github.action_path }}

    - name : Run goodbye.sh
      run  : goodbye.sh
      shell : bash
